<div ng-repeat="x in eksperimenter | orderBy : sortering.value " render-finished="renderFinished()">

	<div bs-tabs class="control-group col-md-12 eksperiment-block" id="eksperiment-cnt-{{ x.eksperiment_id }}">

 		<button class="btn btn-default btn-xs btn-eksperiment-delete" title="Slet eksperiment / myrejagt" ng-click="deleteEksperiment(x.eksperiment_id)">
			<i class="fa fa-remove text-danger"></i>
		</button>

		<!--------- oversigt -------->
		<div bs-pane data-title="Oversigt" style="padding-left:0px;">
			<form novalidate id="formOversigt{{ x.eksperiment_id }}">
				<input type="hidden" name="eksperiment_id" value="{{ x.eksperiment_id }}" />

				<div class="col-md-6" style="min-height:300px !important;">

					<!-- different popovers depending on skole / privat -->
					<label class="normal required">
						Navn på eksperiment
						<i ng-if="projekt_id == 0"
							info-sm 
							info-popover="Her kan du navngive dit eksperiment. F.eks. I forhold til hvor du udførte eksperimentet – ”ved sommerhuset”, ”under æbletræet” el. lign. Eller f.eks. I forhold til hvem du udførte eksperimentet sammen med – ”Mormor & Morfar”, ”5.b”, ”Gunnar, Lise og Thor” el. lign. Feltet er ikke obligatorisk.">
						</i>
						<i ng-if="projekt_id != 0"
							info-sm 
							info-popover="Her kan du navngive dit eksperiment. F.eks. I forhold til hvor du udførte eksperimentet – ”ved boldbanen”, ”under æbletræet på legepladsen” el. lign. Eller f.eks. I forhold til hvem du udførte eksperimentet sammen med –”5.b”, ”Hold 4”, ”Gunnar, Lise og Thor” el. lign. Feltet er ikke obligatorisk.">
						</i>
					</label>


					<input type="text" class="form-control bold input-lg" select-on-click ng-model="x.titel" name="titel" />
	
					<div class="col-md-4" style="padding-left: 0px !important;">
						<label class="normal required">Dato</label>
						<input type="text" class="form-control bold input-lg" ng-model="x.dato" name="dato" bs-datepicker data-date-format="dd-MM-yyyy" size="7" data-autoclose="true" data-container="body" />
					</div>

					<div class="col-md-4" style="padding-left: 0px !important;">
						<label class="normal required">Start tidspunkt</label>
						<input type="text" class="form-control bold input-lg" ng-model="x.start_tid" name="start_tid" bs-timepicker data-time-format="HH:mm" data-time-type="string" data-length="1" data-minute-step="1" data-arrow-behavior="picker" data-autoclose="true" data-container="body" />
					</div>

					<div class="col-md-4" style="padding-left: 0px !important;">
						<label class="normal required">Slut tidspunkt</label>
						<input type="text" class="form-control bold input-lg" ng-model="x.slut_tid" name="slut_tid" bs-timepicker data-time-format="HH:mm" data-length="1" data-minute-step="1" data-arrow-behavior="picker" data-autoclose="true" data-container="body" />
					</div>

					<label class="normal">Myrejagt-id :</label>
					<input type="text" class="form-control bold input-lg" select-on-click value="{{ x.myrejagt_id }}" readonly />

				</div>

				<div class="col-md-6">
					<leaflet id="{{ x.mapId }}" class="eksperiment-map" center="x.map.center" defaults="x.map.defaults" layers="x.map.layers" markers="x.map.markers" events="x.map.events" height="280px" style="border:1px solid #ccc;border-radius:5px;"></leaflet>
				</div>

				<button class="btn btn-default btn-eksperiment-save" 
								ng-class="{ 'btn-success' : eksperimentFormChanged('formOversigt{{ x.eksperiment_id }}') }"
								ng-click="updateEksperiment('formOversigt'+x.eksperiment_id)" 
								ng-disabled="!eksperimentFormChanged('formOversigt{{ x.eksperiment_id }}')">
					<i class="fa fa-check"></i>
					Gem ændringer
				</button>	

			</form>
		</div>

	<!---------- lokalitet ------------->
		<div bs-pane data-title="Lokalitet" style="padding-left:0px;">

			<form novalidate id="formLokalitet{{ x.eksperiment_id }}">

				<input type="hidden" name="eksperiment_id" value="{{ x.eksperiment_id }}" />
				<input type="hidden" name="geometryWkt" value="{{ x.geometryWkt }}" />
				<input type="hidden" name="lat" value="{{ x.lat }}" />
				<input type="hidden" name="lng" value="{{ x.lng }}" />

				<div class="control-group col-md-6">

					<label class="normal required">Lokalitet</label>
					<input type="text" class="form-control bold input-md" ng-model="x.adresse" select-on-click adresse-opslag adresse-type="{{ x.adresseType }}" on-select="eksperimentAdresseSelect" eksperiment-id="{{ x.eksperiment_id }}" name="adresse" />
						
					<div class="col-sm-12">
						<label class="radio-inline" 
							bs-popover 
							data-container="html" 
							data-trigger="hover" 
							data-placement="top" 
							data-content="Opslag i Geodatastyrelsens stednavne-register. Her kan du søge på bygninger, naturområder, seværdigheder etc. med opslag på populærnavne."> 
							<input type="radio" class="exclude-from-form" ng-model="x.adresseType" name="opslag" value="stednavne_v2" />
							Stednavne
						</label>
						<label class="radio-inline" 
							bs-popover 
							data-container="html" 
							data-trigger="hover" 
							data-placement="top" 
							data-content="Opslag i Geodatastyrelsens adresse-register. Her kan du søge på vejnavn og husnr. "> 
							<input type="radio" class="exclude-from-form" ng-model="x.adresseType" name="opslag" value="adresser" checked  />
							Adresser
						</label>
						<label class="radio-inline"> 
							<input type="radio" class="exclude-from-form" ng-model="x.adresseType" name="opslag" value="" />
							Fritekst
						</label>
					</div>
	
					<div class="col-sm-12" style="min-height:10px;"></div>

					<div class="control-group col-md-3" style="padding-left: 0px !important;">
						<label class="normal required">Postnr</label>
						<input type="text" class="form-control bold input-md" ng-model="x.postnr" name="postnr"/>
					</div>

					<div class="control-group col-md-9" style="padding-right: 0px !important; padding-left:0px !important;">
						<label class="normal required">By</label>
						<input type="text" class="form-control bold input-md" ng-model="x.by" name="by"/>
					</div>

					<div class="control-group col-md-7" style="padding-left: 0px !important;">
						<label class="normal required">Kommune</label>
						<input type="text" class="form-control bold input-md" ng-model="x.kommune" id="kommune" name="kommune" />
					</div>

					<div class="control-group col-md-5" style="padding-right: 0px !important; padding-left:0px !important;">
						<label class="normal required">Region</label>
						<input type="text" class="form-control bold input-md" ng-model="x.region" name="region"/>
					</div>

				</div>

				<div class="control-group col-md-6">
					<leaflet id="{{ x.mapId }}_lok" class="eksperiment-map" center="x.map.center" defaults="x.map.defaults" layers="x.map.layers" markers="x.map.markers" events="x.map.events" height="280px" style="border:1px solid #ccc;border-radius:5px;"></leaflet>
				</div>

			</form>		
			<button class="btn btn-default btn-eksperiment-save" 
							ng-class="{ 'btn-success' : eksperimentFormChanged('formLokalitet{{ x.eksperiment_id }}') }"
							ng-click="updateEksperiment('formLokalitet'+x.eksperiment_id)" 
							ng-disabled="!eksperimentFormChanged('formLokalitet{{ x.eksperiment_id }}')">
				<i class="fa fa-check"></i>
				Gem ændringer
			</button>	
		</div>

	<!---------- resultat ------------->
<div bs-pane data-title="Miljødata og Resultater">

	<form novalidate id="formResultater{{ x.eksperiment_id }}">

	<table style="float:left;clar:none;border-spacing:15px 3px;border-collapse: separate;">
		<thead>
				<tr>
					<th class="normal">
						Miljødata
						<i info-sm info-popover="Her skal du taste oplysninger omkring vind og vejr under dit eksperiment. Dine miljødata hjælper forskerne med at lære myrerne og deres levevis bedre at kende. "></i>
					</th>
					<th style="width: 150px;"></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="bold">°C</td>
					<td>
						<input type="number" 
							placeholder="0" 
							class="form-control" 
							ng-model="x.temp" 
							name="temp"
							ng-class="{ 'has-value' : x.temp != undefined }"
							style="width:80px !important;" 
							min="-50"
							max="50"
						/>  

					</td>
				</tr>

				<tr>
					<td class="bold">Vejr</td>
					<td>
										<button data-placeholder="Vælg"
														style="width: 99% !important;text-align:left;"
													  type="button" 
														class="btn btn-default select" 
														ng-model="x.vejr" 
														name="vejr"
														data-toggle="true" 
														ng-class="{ 'has-value' : x.vejr != undefined }"
														bs-options="i.value as i.label for i in items.vejr" 
														bs-select>
											<span class="caret"></span>
										</button>

					</td>
				</tr>

				<tr>
					<td class="bold">Sol</td>
					<td>
										<button data-placeholder="Vælg"
														style="width: 99% !important;text-align:left;"
													  type="button" 
														class="btn btn-default select" 
														ng-model="x.sol" 
														name="sol"
														data-toggle="true" 
														ng-class="{ 'has-value' : x.sol != undefined }"
														bs-options="i.value as i.label for i in items.sol" 
														bs-select>
											<span class="caret"></span>
										</button>

					</td>
				</tr>

				<tr>
					<td class="bold">Vind</td>
					<td>
										<button data-placeholder="Vælg"
														style="width: 99% !important;text-align:left;"
													  type="button" 
														class="btn btn-default select" 
														name="vind"
														ng-model="x.vind" 
														data-toggle="true" 
														ng-class="{ 'has-value' : x.vind != undefined }"
														bs-options="i.value as i.label for i in items.vind" 
														bs-select>
											<span class="caret"></span>
										</button>

					</td>
				</tr>

			</tbody>
		</table>


	<table style="border-spacing:15px 3px;border-collapse: separate; float:left;margin-left:50px;">
		<thead>
			<tr>
				<th></th>
				<th></th>
				<th colspan="2" class="normal text-center">
					Antal myrer indsamlet
				</th>
			</tr>
			<tr>
				<th></th>
				<th class="normal">
					Madding væk?
					<i info-sm info-popover="Var maden væk da eksperimentet blev afsluttet? Maden kan være blæst væk, være taget af fugle eller andet. – Detaljer kan noteres under ‘Bemærkninger’"></i>
				</th>
				<th class="normal">
					Optælling
					<i info-sm info-popover="Antal myrer inden indsamling. Her skriver du det antal myrer du noterede på det pågældende fødeemne ved optælling før indsamling af myrerne. Da det kan være svært at tælle myrerne kan du have fået et gennemsnit med decimaler efter dine optællinger."></i>
				</th>
				<th class="normal">
					Efter frys
					<i info-sm info-popover="Antal myrer efter frysning. Her skriver du det antal myrer du noterede på det pågældende fødeemne ved optælling efter indsamling og frysning af myrerne. "></i>
				</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="d in x.Data">
					<td class="bold"> {{ d.madding }} </td>
					<td style="text-align:center;"> 
						<checkbox ng-model="d.madding_stjaalet" name="madding_sjaalet" title="test"></checkbox>
					</td>
					<td> 
						<input type="text" 
									placeholder="0.0"
									only-digits
									style="width: 90px;"
									name="myrer_indsamlet"
									class="form-control"
									select-on-click
									ng-model="d.myrer_indsamlet"
									ng-class="{ 'has-value' : d.myrer_indsamlet != undefined }">
					</td>
					<td> 
						<input type="text" 
									placeholder="0"
									style="width: 90px;"
									only-numbers
									name="myrer_frysning"
									class="form-control"  
									select-on-click
									ng-model="d.myrer_frysning"
									ng-class="{ 'has-value' : d.myrer_frysning != undefined }">
					</td>
				</tr>
			</tbody>
		</table>

	</form>
			<button class="btn btn-default btn-eksperiment-save" 
							ng-class="{ 'btn-success' : eksperimentFormChanged('formResultater{{ x.eksperiment_id }}') }"
							ng-click="updateEksperimentData(x.eksperiment_id)" 
							ng-disabled="!eksperimentFormChanged('formResultater{{ x.eksperiment_id }}')">
				<i class="fa fa-check"></i>
				Gem ændringer
			</button>	

	</div>

	<div bs-pane data-title="Upload billede og video">

		<div class="control-group col-md-6">
			Billede

			<button class="btn btn-default btn-xs pull-right" 
				title="Fjern billede (billedet bliver slettet fra serveren)"
				ng-disabled="x.upload_billede == undefined"
				ng-class="{ 'btn-danger' : x.upload_billede != undefined }"
				ng-click="deleteImage(x.eksperiment_id, x.upload_billede)">
				<i class="fa fa-remove"></i>
			</button>

			<button class="btn btn-success btn-xs pull-right" 
				style="margin-right: 5px;"
				ng-click="uploadImage(x.eksperiment_id, x.upload_billede)">Upload billede / belæg
			</button>
			<div class="upload-cnt">
				<img class="upload" ng-click="uploadImage(x.eksperiment_id, x.upload_billede)" src="{{ x.upload_billede }}" />
			</div>
		</div>

		<div class="control-group col-md-6">
			Video

			<button class="btn btn-default btn-xs pull-right" 
				title="Fjern video (filen bliver slettet fra serveren)"
				ng-disabled="x.upload_video == undefined"
				ng-class="{ 'btn-danger' : x.upload_video != undefined }"
				ng-click="deleteVideo(x.eksperiment_id, x.upload_video)">
				<i class="fa fa-remove"></i>
			</button>

			<button class="btn btn-success btn-xs pull-right" 
				style="margin-right: 5px;"
				ng-click="uploadVideo(x.eksperiment_id, x.upload_video)">Upload Video
			</button>

			<div class="upload-cnt">
        <section class="video" ng-video VVng-model="test">
					<video XXXautoplay="false" vi-screen ng-src="{{ x.upload_video }}" src="{{ x.upload_video }}"></video>
						<section vi-controls="" class="controls">
                <span ng-click="interface.controls.play()" title="Afspil" class="glyphicon glyphicon-play"></span>
                <span ng-click="interface.controls.pause()" title="Pause" class="glyphicon glyphicon-pause"></span>
            </section>
				</section>
			</div>
		</div>

	</div>

</div>




